
Started training: seed: 1001, linear: True, factor: 1, delta: 0.01
C:\Users\calle\Anaconda3\envs\bachelor\Lib\site-packages\torch\functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ..\aten\src\ATen\native\TensorShape.cpp:3484.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]




































































































































































































  5%|███████▋                                                                                                                                                  | 249/5000 [06:52<2:12:51,  1.68s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]
























































































































































































































 10%|███████████████▎                                                                                                                                          | 499/5000 [17:48<2:03:37,  1.65s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]

























































































































































































































 15%|███████████████████████                                                                                                                                   | 749/5000 [28:45<1:55:03,  1.62s/it]
>>> Testing: -seed-1001-linear-True-delta-0.01-factor-1-r_basis_diff-1-r_basis_var-2-frame-750-epsilon-0.73-loss-0.423




























































































































































































































 20%|██████████████████████████████▊                                                                                                                           | 999/5000 [39:54<1:48:25,  1.63s/it]
>>> Testing: -seed-1001-linear-True-delta-0.01-factor-1-r_basis_diff-1-r_basis_var-2-frame-1000-epsilon-0.64-loss-0.476




























































































































































































































 25%|██████████████████████████████████████▏                                                                                                                  | 1249/5000 [50:59<1:47:38,  1.72s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]






























































































































































































































 30%|█████████████████████████████████████████████▎                                                                                                         | 1499/5000 [1:02:09<1:41:08,  1.73s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]



































































































































































































































 35%|████████████████████████████████████████████████████▊                                                                                                  | 1749/5000 [1:13:31<1:36:37,  1.78s/it]
>>> Testing: -seed-1001-linear-True-delta-0.01-factor-1-r_basis_diff-1-r_basis_var-2-frame-1750-epsilon-0.37-loss-0.455



































































































































































































































 40%|████████████████████████████████████████████████████████████▎                                                                                          | 1999/5000 [1:24:51<1:26:24,  1.73s/it]
>>> Testing: -seed-1001-linear-True-delta-0.01-factor-1-r_basis_diff-1-r_basis_var-2-frame-2000-epsilon-0.28-loss-0.435
































































































































































































































 45%|███████████████████████████████████████████████████████████████████▉                                                                                   | 2249/5000 [1:36:20<1:20:18,  1.75s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]






































































































































































































































 50%|███████████████████████████████████████████████████████████████████████████▍                                                                           | 2499/5000 [1:47:52<1:13:18,  1.76s/it]
>>> Testing: -seed-1001-linear-True-delta-0.01-factor-1-r_basis_diff-1-r_basis_var-2-frame-2500-epsilon-0.1-loss-0.488







































































































































































































































 55%|███████████████████████████████████████████████████████████████████████████████████                                                                    | 2749/5000 [1:59:23<1:06:37,  1.78s/it]
  0%|                                                                                                                                                                        | 0/10 [00:00<?, ?it/s]






















































 56%|████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 2800/5000 [2:05:00<1:38:13,  2.68s/it]
Traceback (most recent call last):
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\cliff_car_experiments.py", line 146, in <module>
    train_data = agent.train(train_frames = train_frames,
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\cliff_car_robust_agent.py", line 153, in train
    loss = self.update_model()
           ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\cliff_car_robust_agent.py", line 105, in update_model
    loss, robust_estimator = self._compute_dqn_loss(*samples)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\cliff_car_robust_agent.py", line 74, in _compute_dqn_loss
    Q_vals = self.dqn(torch.FloatTensor(next_state).to(device))  # Should all have the same action
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\calle\Anaconda3\envs\bachelor\Lib\site-packages\torch\nn\modules\module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\network.py", line 64, in forward
    basis = self.radial_basis(x)
            ^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\calle\Documents\GitHub\robust-rl\cliff_car\network.py", line 72, in radial_basis
    basis[:,i] = self.mNormal[i].log_prob(position).exp()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\calle\Anaconda3\envs\bachelor\Lib\site-packages\torch\distributions\multivariate_normal.py", line 216, in log_prob
    M = _batch_mahalanobis(self._unbroadcasted_scale_tril, diff)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\calle\Anaconda3\envs\bachelor\Lib\site-packages\torch\distributions\multivariate_normal.py", line 54, in _batch_mahalanobis
    bx = bx.permute(permute_dims)
         ^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt